<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="iwc">

	<select id="selectTwoInitIwc" parameterType="map" resultType="Iwc">
		<![CDATA[
			SELECT *
			FROM
			(SELECT user_ID, user_NM, user_NICKNM, picture_NM
			FROM TB_USER
			JOIN (SELECT user_ID, gender FROM TB_PROFILE WHERE target_GB = 0) USING (user_ID)
			JOIN (SELECT user_ID, picture_NM FROM TB_PROFILE_PICTURE WHERE thumnail_FL = 1) USING (user_ID)
			WHERE gender = (SELECT GENDER FROM TB_PROFILE WHERE user_ID = #{userId} AND target_GB = '1')
			ORDER BY DBMS_RANDOM.VALUE)
			WHERE ROWNUM <= #{round}
		]]>
	</select>

</mapper>